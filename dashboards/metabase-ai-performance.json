{
  "name": "AI Performance & Model Insights Dashboard",
  "description": "AI model accuracy, predictions, and real-time performance metrics",
  "cards": [
    {
      "name": "Total AI Predictions (24h)",
      "type": "scalar",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT COUNT(*) as prediction_count FROM ai_prediction_logs WHERE created_at >= NOW() - INTERVAL '24 hours'"
        }
      },
      "visualization": {
        "type": "scalar",
        "settings": {
          "compact_numbers": true,
          "trend": {
            "query": "SELECT COUNT(*) FROM ai_prediction_logs WHERE created_at >= NOW() - INTERVAL '48 hours' AND created_at < NOW() - INTERVAL '24 hours'"
          }
        }
      }
    },
    {
      "name": "Average Model Accuracy",
      "type": "gauge",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT AVG(accuracy_score) * 100 as avg_accuracy FROM ai_model_metrics WHERE measured_at >= NOW() - INTERVAL '7 days'"
        }
      },
      "visualization": {
        "type": "gauge",
        "settings": {
          "min": 0,
          "max": 100,
          "suffix": "%",
          "ranges": [
            {"from": 0, "to": 70, "color": "#EF8C8C"},
            {"from": 70, "to": 85, "color": "#F9CF48"},
            {"from": 85, "to": 100, "color": "#88BF4D"}
          ]
        }
      }
    },
    {
      "name": "AI Worker Response Time",
      "type": "scalar",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT AVG(response_time_ms) as avg_response_time FROM ai_prediction_logs WHERE created_at >= NOW() - INTERVAL '1 hour'"
        }
      },
      "visualization": {
        "type": "scalar",
        "settings": {
          "suffix": "ms",
          "decimals": 0
        }
      }
    },
    {
      "name": "Prediction Types Distribution",
      "type": "categorical",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT prediction_type, COUNT(*) as count FROM ai_prediction_logs WHERE created_at >= NOW() - INTERVAL '7 days' GROUP BY prediction_type ORDER BY count DESC"
        }
      },
      "visualization": {
        "type": "donut",
        "settings": {
          "colors": {
            "revenue_forecast": "#509EE3",
            "churn_prediction": "#DC267F",
            "sentiment_analysis": "#88BF4D",
            "anomaly_detection": "#FE6100",
            "recommendation": "#785EF0"
          }
        }
      }
    },
    {
      "name": "Model Performance Over Time",
      "type": "timeseries",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT DATE_TRUNC('hour', measured_at) as hour, model_name, AVG(accuracy_score) * 100 as accuracy, AVG(precision_score) * 100 as precision, AVG(recall_score) * 100 as recall FROM ai_model_metrics WHERE measured_at >= NOW() - INTERVAL '7 days' GROUP BY DATE_TRUNC('hour', measured_at), model_name ORDER BY hour"
        }
      },
      "visualization": {
        "type": "line",
        "settings": {
          "series": [
            {"name": "Accuracy", "color": "#509EE3"},
            {"name": "Precision", "color": "#88BF4D"},
            {"name": "Recall", "color": "#785EF0"}
          ],
          "y_axis": {"min": 0, "max": 100, "suffix": "%"}
        }
      }
    },
    {
      "name": "Prophet Forecast Accuracy",
      "type": "timeseries",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT f.prediction_date as date, f.predicted_revenue, a.actual_revenue, ABS(f.predicted_revenue - a.actual_revenue) / a.actual_revenue * 100 as error_percentage FROM ai_revenue_forecasts f LEFT JOIN daily_revenue_actuals a ON DATE(f.prediction_date) = DATE(a.date) WHERE f.prediction_date >= NOW() - INTERVAL '30 days' AND a.actual_revenue IS NOT NULL ORDER BY f.prediction_date"
        }
      },
      "visualization": {
        "type": "line",
        "settings": {
          "series": [
            {"name": "Predicted Revenue", "color": "#509EE3", "style": "dashed"},
            {"name": "Actual Revenue", "color": "#88BF4D"}
          ],
          "y_axis_2": {
            "series": "error_percentage",
            "color": "#EF8C8C",
            "suffix": "%"
          }
        }
      }
    },
    {
      "name": "FAISS Vector Search Performance",
      "type": "table",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT tenant_id, COUNT(*) as search_count, AVG(response_time_ms) as avg_response_time, AVG(result_count) as avg_results, MAX(index_size) as index_size FROM faiss_query_logs WHERE created_at >= NOW() - INTERVAL '24 hours' GROUP BY tenant_id ORDER BY search_count DESC LIMIT 20"
        }
      },
      "visualization": {
        "type": "table",
        "settings": {
          "columns": {
            "avg_response_time": {"suffix": "ms", "decimals": 1},
            "avg_results": {"decimals": 1},
            "index_size": {"format": "bytes"}
          }
        }
      }
    },
    {
      "name": "Sentiment Analysis Distribution",
      "type": "categorical",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT sentiment, COUNT(*) as count, AVG(confidence) as avg_confidence FROM sentiment_analysis_results WHERE created_at >= NOW() - INTERVAL '7 days' GROUP BY sentiment ORDER BY count DESC"
        }
      },
      "visualization": {
        "type": "bar",
        "settings": {
          "colors": {
            "positive": "#88BF4D",
            "neutral": "#F9CF48",
            "negative": "#EF8C8C"
          },
          "stacking": false
        }
      }
    },
    {
      "name": "Anomaly Detections (24h)",
      "type": "table",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT metric_name, anomaly_value, expected_range, severity, detected_at, affected_entities FROM anomaly_detections WHERE detected_at >= NOW() - INTERVAL '24 hours' ORDER BY detected_at DESC, severity DESC LIMIT 50"
        }
      },
      "visualization": {
        "type": "table",
        "settings": {
          "columns": {
            "detected_at": {"date_format": "YYYY-MM-DD HH:mm:ss"},
            "severity": {
              "conditional_formatting": {
                "critical": {"color": "#DC267F", "bold": true},
                "high": {"color": "#FE6100"},
                "medium": {"color": "#F9CF48"},
                "low": {"color": "#88BF4D"}
              }
            }
          }
        }
      }
    },
    {
      "name": "Model Training History",
      "type": "table",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT model_name, model_version, training_started_at, training_completed_at, EXTRACT(EPOCH FROM (training_completed_at - training_started_at))/60 as training_duration_minutes, dataset_size, final_accuracy, deployment_status FROM ai_model_training_logs WHERE training_started_at >= NOW() - INTERVAL '30 days' ORDER BY training_completed_at DESC LIMIT 20"
        }
      },
      "visualization": {
        "type": "table",
        "settings": {
          "columns": {
            "training_started_at": {"date_format": "YYYY-MM-DD HH:mm"},
            "training_completed_at": {"date_format": "YYYY-MM-DD HH:mm"},
            "training_duration_minutes": {"suffix": " min", "decimals": 1},
            "final_accuracy": {"format": "percent", "decimals": 2},
            "deployment_status": {
              "conditional_formatting": {
                "deployed": {"color": "#88BF4D"},
                "pending": {"color": "#F9CF48"},
                "failed": {"color": "#EF8C8C"}
              }
            }
          }
        }
      }
    },
    {
      "name": "GCS Model Storage Usage",
      "type": "scalar",
      "query": {
        "database": "omni_db",
        "type": "native",
        "native": {
          "query": "SELECT SUM(model_size_bytes) as total_size FROM gcs_model_artifacts WHERE tenant_id = {{tenant_id}}"
        },
        "parameters": [
          {"name": "tenant_id", "type": "text", "default": "default"}
        ]
      },
      "visualization": {
        "type": "scalar",
        "settings": {
          "format": "bytes",
          "compact_numbers": true
        }
      }
    }
  ],
  "filters": [
    {
      "name": "Date Range",
      "type": "date",
      "default": "past7days"
    },
    {
      "name": "Model Type",
      "type": "category",
      "options": ["all", "prophet", "lstm", "transformer", "faiss", "pyod"]
    },
    {
      "name": "Tenant",
      "type": "text",
      "default": "default"
    }
  ],
  "layout": {
    "grid": [
      {"x": 0, "y": 0, "w": 3, "h": 2, "card": "Total AI Predictions (24h)"},
      {"x": 3, "y": 0, "w": 3, "h": 2, "card": "Average Model Accuracy"},
      {"x": 6, "y": 0, "w": 3, "h": 2, "card": "AI Worker Response Time"},
      {"x": 9, "y": 0, "w": 3, "h": 2, "card": "GCS Model Storage Usage"},
      {"x": 0, "y": 2, "w": 4, "h": 3, "card": "Prediction Types Distribution"},
      {"x": 4, "y": 2, "w": 4, "h": 3, "card": "Sentiment Analysis Distribution"},
      {"x": 8, "y": 2, "w": 4, "h": 3, "card": "FAISS Vector Search Performance"},
      {"x": 0, "y": 5, "w": 12, "h": 4, "card": "Model Performance Over Time"},
      {"x": 0, "y": 9, "w": 12, "h": 4, "card": "Prophet Forecast Accuracy"},
      {"x": 0, "y": 13, "w": 12, "h": 5, "card": "Anomaly Detections (24h)"},
      {"x": 0, "y": 18, "w": 12, "h": 5, "card": "Model Training History"}
    ]
  }
}
